---
title: "Toronto Dinesafe Analysis by Number of Different Status and Severity"
author: 
  - Siyu Li
thanks: "Code and data are available at: <https://github.com/SiyuLii/Toronto_Dinesafe_Ananlysis.git>"
date: today
date-format: long
abstract: "From the information from Open Data Toronto about Dinesafe, the dataset shows the establishment type, establishment status, inspection date, inspection issue and other factors based on Ontario Food Premises Regulation (493/17). The author uses this data to analyze the number of restaurants' status as pass, conditional pass and closed in 2022 and 2023 and compare the percentage of passes between two years. Finally, author find the perentage of pass decrease every year but the difffernece only 0.003% which can be ignored and the percentage of establishments have problem is over 50% which means half of estabishments have problems. This paper helps to get a more general idea of how Toronto's food and drink establishments' perform, which can give readers a clear idea to explore more about food safety in the city."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

#install.packages("here")
#install.packages("knitr")
#install.packages("dplyr")
#install.packages("ggplot2")

library(AER)
library(knitr)
library(dplyr)
library(tidyverse)
#library(palmerpenguins)
library(here)
library(ggplot2)

#### Import Data ####
dinesafe_program_clean <-
  read_csv(
   here::here("inputs/data/cleaned_data.csv"),
    show_col_types = FALSE
  )
```


# Introduction {#sec-intro}

Health become a common topic with the development of living standards nowadays. Food safety is one of the most important parts of health. Food safety is the science of handling, preparing and storing food to reduce the risk of foodborne illnesses. Food contaminated with harmful bacteria, viruses, parasites or chemical substances can cause many illnesses(Public Health Ontario). 

This paper explores the number of establishments that satisfy the Ontario Food Premises Regulation (493/17) which is enacted by the Ontario government and how it is distributed. This data is highly related to public health and the tourism industry. By comparing the number of passed establishments, readers can easily know if the number is increased, decreased or kept constant. The number of pass establishments corresponds to the sanitary condition of the city. If the condition for establishments violates the enactment, it may cause foodborne diseases. Foodborne diseases impede socioeconomic development by straining healthcare systems and harming national economies, tourism and trade(World Health Organization). As an indicator, it is necessary to have the data on establishment status. In another way, this data reflects living standard of citizens ,which estimates the ability of the government. In this paper, author will explore the how the number of passed and conditional pass restaurant changes in years and how the number of different severity changed.

The reminder of this paper is construed with data section(@sec-data) and reference section(@sec-ref). The Data section discusses origin of data, how the data is distributed by years and establishment status. Then, compare the establishment status by years. This lets the difference and change can be observed directly. 



# Data {#sec-data}

The data is from OpenDataToronto[@opendatatoronto] by city of Toronto. Only one dataset is used. The original dataset include seventeen variables which is id of the establishments, address, number of inspection per year and other relative variables. However, some of those variables are not related to author's hypothesis. Thus, only three variables are selected for the analysis. Those three variables are establishment status, inspection date and severity. With those variables' data, it express how the establishments perform and number of establishments pass the inspection. The trend of change in number can show the active performace in food industry. Thus, author can know the fact in Toronto and how te living standard about dinesafe for citizens.

Author analysis data in R[@citeR] by using package 'tidyver()'[@tidyverse] and 'knitr()'[@knitr] to generate the table. Also,'summarise()' [@dplyr] used to get number of pass, conditional pass, and different severity level. This form to create Table(@tbl-status).

```{r}
#| label: tbl-status
#| tbl-cap: Number of Establishment Get Pass, Conditional Status in Different Year
#| echo: false
#| warning: false
#| message: false

status_by_year <- dinesafe_program_clean |>
  group_by(inspection_year, establishment_status) |>
  summarise(count = n(), .groups = "keep") 

  knitr::kable(status_by_year,'markdown',col.names = c("Status", " Severity", "Count"),align = 'c')
```
Next, by using similar package to get table for severity. In this table(@tbl-severity), it shows five level of severity of inspection. By the table, it obviously show that for number of state is empty(refer to establishment have no problem during inspection) is the most. Establishments have minor state be the second large, which means those establishments have small pronblem but it is not serious.
```{r}
#| label: tbl-severity
#| tbl-cap: Number of Establishment Have Five Different Severity Level From 2022 to 2024
#| echo: false
#| warning: false
#| message: false

severity_by_year <- dinesafe_program_clean |>
  group_by(inspection_year, severity) |>
  summarise(count = n(), .groups = "keep") 

  knitr::kable(severity_by_year,'markdown',col.names = c("Inspection Year", " Severity", "Count"),align = 'c')

```

By the first table(@tbl-status), it shows there is increase in number of establishments in 2023. It implies more establishments open in 2023 compare to 2022. In this table, it include data in 2024. It is obvious the number of establishments is smaller than 2022 and 2023.  

```{r}
#| label: fig-establishment_status
#| fig-cap: Number of Pass And Conditional Pass From 2022 to 2024
#| echo: false
#| warning: false
#| message: false

# this code from Professor Rohan's note  
# https://tellingstorieswithdata.com/03-workflow.html

data("dinesafe_program_clean", package = "AER")

dinesafe_program_clean |>
  ggplot(aes(x = establishment_status)) +
  geom_histogram(stat = "count")

```

```{r}
#| label: fig-severity
#| fig-cap: Number of Five Different Severity Level From 2022 to 2024
#| echo: false
#| warning: false
#| message: false

# this code from Professor Rohan's note  
# https://tellingstorieswithdata.com/03-workflow.html
data("dinesafe_program_clean", package = "AER")

dinesafe_program_clean |>
  ggplot(aes(x = severity)) +
  geom_histogram(stat = "count")

```

In figure(@fig-establishment_status) and figure(@fig-severity) use 'ggplot' in package ggplot2[@ggplot2] to draw the histogram figure. By this histogram, the first figure show the strong difference between pass and conditional pass. As there are no establishment get closed status, it only show two status.

By the figure(@fig-severity), it shows the distribution of different level. From it, it express that most of establishments in Toronto have no problems during inspection and the number of significant is large. This means there are certain number of establishments exist.


By tables and figures in this paper, it can clearly show that in 2023 there is increase in number of establishments and number of conditional pass. No establishments get closed status implies establishment in Toronto organized well and clean. It provide a safe environment for citizen. By those, it implies Toronto's economic growth is positive as more establishments open in 2023 and economic recovery from pandemic happening. 


\newpage


# References{#sec-ref}


