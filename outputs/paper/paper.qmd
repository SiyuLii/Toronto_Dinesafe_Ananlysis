---
title: "Dinesafe explore percentage of pass"
subtitle: "My subtitle if needed"
author: 
  - Siyu Li
thanks: "Code and data are available at: <https://github.com/SiyuLii/Dinesafe_Analysis.git>"
date: today
date-format: long
abstract: "From the information from Open Data Toronto about Dinesafe, the dataset shows the establishment type, establishment status, inspection date, inspection issue and other factors based on Ontario Food Premises Regulation (493/17). The author uses this data to analyze the number of restaurants' status as pass, conditional pass and closed in 2022 and 2023 and compare the percentage of passes between two years. This paper helps to get a more general idea of how Toronto's food and drink establishments' perform, which can give readers a clear idea to explore more about food safety in the city."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

#install.packages("here")
#install.packages("knitr")
#install.packages("dplyr")

library(knitr)
library(dplyr)
library(tidyverse)
library(palmerpenguins)
library(here)
library(knitr)

#### Import Data ####
dinesafe_program_clean <-
  read_csv(
   here::here("inputs/data/cleanded_data.csv"),
    show_col_types = FALSE
  )
```

# Table of Contents

- [Introduction](#section-1)
- [Data](#section-2)
- [Reference](#section-3)


# Introduction

Health become a common topic with the development of living standards nowadays. Food safety is one of the most important parts of health. Food safety is the science of handling, preparing and storing food to reduce the risk of foodborne illnesses. Food contaminated with harmful bacteria, viruses, parasites or chemical substances can cause many illnesses(Public Health Ontario). 

This paper explores the number of establishments that satisfy the Ontario Food Premises Regulation (493/17) which is enacted by the Ontario government and how it is distributed. This data is highly related to public health and the tourism industry. By comparing the number of passed establishments, readers can easily know if the number is increased, decreased or kept constant. The number of pass establishments corresponds to the sanitary condition of the city. If the condition for establishments violates the enactment, it may cause foodborne diseases. Foodborne diseases impede socioeconomic development by straining healthcare systems and harming national economies, tourism and trade(World Health Organization). As an indicator, it is necessary to have the data on establishment status. In another way, this data reflects living standard of citizens ,which estimates the ability of the government. In this paper, author will explore the how the number of passed and conditional pass restaurant changes in years and how the number of different severity changed.

The reminder of this paper is construed with data section @sec-data and reference section. @sec-ref The Data section discusses origin of data, how the data is distributed by years and establishment status. Then, compare the establishment status by years. This lets the difference and change can be observed directly. 



# Data {#sec-data}

The data is from OpenDataToronto[@opendatatoronto] by city of Toronto. Only one dataset is used. The original dataset include seventeen variables which is id of the establishments, address, number of inspection per year and other relative variables. However, some of those variables are not related to author's hypothesis. Thus, only three variables are selected for the analysis. Those three variables are establishment status, inspection date and severity. With those variables' data, it express how the establishments perform and number of establishments pass the inspection. This can directly 

Author analysis data in R[@citeR] by using package 'tidyver()'[@tidyverse] and 'knitr()'[@knitr] to generate the table. Also,'summarise()' [@dplyr] used to get number of pass, conditional pass, and different severity level. This form to create Table (@tbl-dinesafe)

```{r}
#| label: tbl-status
#| tbl-cap: Number of Establishment Get Pass, Conditional Status in Different Year
#| echo: false

status_by_year <- dinesafe_program_clean |>
  group_by(inspection_year, establishment_status) |>
  summarise(count = n(), .groups = "keep") |> 
  print(kable())
```
Next, by using similar package to get table for severity. In this table, it shows five level of severity of inspection. The
```{r}
#| label: tbl-severity
#| tbl-cap: Number of Establishment Get Pass, Conditional Status in Different Year
#| echo: false

severity_by_year <- dinesafe_program_clean |>
  group_by(inspection_year, severity) |>
  summarise(count = n(), .groups = "keep") |>
  print(kable())

```

```{r}
#| label: tbl-frenquency
#| tbl-cap: Number of Establishment Get Pass, Conditional Status and Three Levels of Severity in Different Year
#| echo: false

merged_data <- merge(status_by_year, severity_by_year, by = "inspection_year", all = TRUE)

# Print the merged data frame
#print(merged_df)

# Create a table using kable
status_severity_table <- merged_data |>
  kable(format = "markdown",
        col.names = c("Year", "Status", "Severity", "Frenquency"),
        caption = "Frequency of Status and Severity by Year")

# Print the table
print(status_severity_table)
```

By the first table@tbl-dinesafe, it shows there is increase in number of establishments in 2023. It implies more establishments open in 2023 compare to 2022. In this table, it include data in 2024. It is obvious the number of establishments is smaller than 2022 and 2023.  

```{r}

hist(status_frequency, main = "Frequency of Status", xlab = "Status", ylab = "Frequency", col = "skyblue", border = "black")
status_frequency <- table(your_data$status)
```


\newpage


# References{#sec-ref}


